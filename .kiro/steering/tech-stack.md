# Tech Stack Standards

## Project Overview

This document establishes the technical standards and conventions for the text-to-Anki CLI application. This Python CLI tool converts plain text files into Anki deck formats for spaced repetition learning.

## Core Technology Stack

### Python Version
- **Target Version**: Python 3.12+ (latest stable)
- **Minimum Supported**: Python 3.10+
- **Rationale**: Use latest Python features while maintaining reasonable compatibility

### CLI Framework
- **Framework**: Typer
- **Version**: Latest stable
- **Rationale**: Modern CLI framework with excellent type hints support, automatic help generation, and intuitive decorator-based API

### Package Management
- **Tool**: Poetry
- **Configuration**: Use `pyproject.toml` for all project configuration
- **Rationale**: Superior dependency resolution, virtual environment management, and modern Python packaging standards

### Code Quality Tools

#### Type Checking
- **Tool**: mypy (REQUIRED)
- **Configuration**: Strict type checking enabled
- **Usage**: All functions, methods, and variables MUST have type hints
- **Command**: `mypy src/`
- **Standards**: 
  - No `Any` types allowed without explicit justification
  - All function parameters and return types must be annotated
  - Class attributes must be typed
  - Use `from __future__ import annotations` for forward references

#### Formatting
- **Tool**: Black
- **Configuration**: Default settings with line length 88
- **Usage**: Automatic formatting on save, pre-commit hooks
- **Command**: `black .`

#### Linting
- **Tool**: Ruff
- **Configuration**: Modern, fast linter replacing flake8/pylint
- **Usage**: Pre-commit hooks and CI/CD pipeline
- **Command**: `ruff check .`

#### Testing
- **Framework**: pytest
- **Coverage**: pytest-cov for coverage reporting
- **Structure**: Tests in `tests/` directory mirroring source structure
- **Command**: `pytest --cov=src`

## Distribution

### Installation Method
- **Primary**: pipx installation
- **Package**: Distributed as pip-installable package
- **Entry Point**: Console script defined in pyproject.toml
- **Command**: `pipx install txt-to-anki`

### Build System
- **Tool**: Poetry build system
- **Output**: Wheel and source distribution
- **Registry**: PyPI for public distribution

## Development Workflow

### Project Structure
```
txt-to-anki/
├── src/
│   └── txt_to_anki/
│       ├── __init__.py
│       ├── cli.py
│       ├── parser.py
│       └── anki_export.py
├── tests/
├── pyproject.toml
├── README.md
└── .gitignore
```

### Development Commands
- **Install dependencies**: `poetry install`
- **Run application**: `poetry run txt-to-anki`
- **Run tests**: `poetry run pytest`
- **Format code**: `poetry run black .`
- **Lint code**: `poetry run ruff check .`
- **Type check**: `poetry run mypy src/` (REQUIRED before commits)
- **Build package**: `poetry build`

### Pre-commit Standards
- Black formatting
- Ruff linting
- mypy type checking (REQUIRED - no commits without passing type checks)
- pytest execution

## Error Handling Standards

### CLI Error Handling
- Use Typer's built-in error handling
- Provide clear, actionable error messages
- Exit codes: 0 (success), 1 (general error), 2 (invalid input)

### Input Validation
- Validate file existence and readability
- Check file format compatibility
- Provide helpful suggestions for common issues

## Documentation Standards

### Code Documentation
- **Type hints REQUIRED for ALL functions, methods, and variables**
- **No code without proper type annotations will be accepted**
- Docstrings following Google style
- README with clear usage examples
- CLI help text generated by Typer

### User Documentation
- Clear installation instructions
- Input format specifications
- Usage examples and common workflows
- Troubleshooting guide

---

This document should be updated as the project evolves and new requirements emerge.